<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Revenue Metrics Project</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/3.0.1/modern-normalize.min.css"
      integrity="sha512-q6WgHqiHlKyOqslT/lgBgodhd03Wp4BEqKeW6nNtlOY4quzyG3VoQKFrieaCeSnuVseNKRGpGeDU3qPmabCANg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=League+Gothic&family=League+Spartan:wght@400;500;600;700&family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/styles.css" />
  </head>

  <body>
    <header class="container page-header">
      <nav class="header-navigation">
        <a
          class="logo header-logo"
          href="./index.html"
          title="Oleksandr's Logo>"
        >
          <img src="./images/logo.ico" alt="Logo" class="logo-img" />
        </a>
        <button class="burger-btn" type="button" data-menu-open>
          <svg class="burger-icon">
            <use href="./images/icons.svg#icon-burger"></use>
          </svg>
        </button>
      </nav>

      MENU

      <div class="menu" data-menu>
        <div class="container menu-container">
          <button class="menu-close-btn" type="button" data-menu-close>
            <svg class="menu-close-btn-icon" width="24" height="24">
              <use href="./images/icons.svg#icon-close"></use>
            </svg>
          </button>
          <nav class="menu-nav">
            <h2 class="menu-title">MENU</h2>
            <ul class="nav-list">
              <li class="nav-item">
                <a
                  class="nav-item-link"
                  href="./index.html"
                  title="Go to Home page"
                  >HOME</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-item-link"
                  href="./projects.html"
                  title="Go to Projects page"
                  >PROJECTS</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-item-link"
                  href="./about.html"
                  title="Go to About me page"
                  >ABOUT ME</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-item-link"
                  href="./contact.html"
                  title="Go to Contact page"
                  >CONTACT</a
                >
              </li>
            </ul>
          </nav>
          <div class="contacts-media">
            <div class="grid">
              <img src="./images/sum.svg" class="icon" alt="sum symbol" />
              <img
                src="./images/storage.svg"
                class="icon"
                alt="storage symbol"
              />
              <img
                src="./images/function.svg"
                class="icon"
                alt="function symbol"
              />
              <img src="./images/chart.svg" class="icon" alt="chart symbol" />
              <img
                src="./images/brainstorm.svg"
                class="icon"
                alt="brainstorm symbol"
              />
              <img
                src="./images/decrease.svg"
                class="icon"
                alt="decrease symbol"
              />
              <img
                src="./images/analysis.svg"
                class="icon"
                alt="analysis symbol"
              />
              <img src="./images/search.svg" class="icon" alt="search symbol" />
              <img
                src="./images/spreadsheet.svg"
                class="icon"
                alt="spreadsheet symbol"
              />
            </div>
            <address class="menu-contacts">
              <ul class="menu-contacts-list">
                <li class="menu-contacts-item">
                  <a
                    class="menu-contacts-mail"
                    href="mailto:honchar.analytics@gmail.com"
                    >honchar.analytics@gmail.com</a
                  >
                </li>
                <li class="menu-contacts-item">
                  <a
                    class="menu-contacts-phone"
                    href="tel:+48733793430"
                    title="Call Oleksandr"
                    >+48 733 793 430</a
                  >
                </li>
              </ul>
            </address>
            <div class="menu-social-media">
              <ul class="menu-social-media-list">
                <li class="menu-social-media-item">
                  <a
                    class="menu-social-media-link"
                    href="https://www.linkedin.com/in/oleksandrhonchar/"
                    title="Discover Oleksandr's LinkedIn profile"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg class="menu-social-media-icon" width="24" height="24">
                      <use href="./images/icons.svg#icon-linkedin"></use>
                    </svg>
                  </a>
                </li>
                <li class="menu-social-media-item">
                  <a
                    class="menu-social-media-link"
                    href="https://www.facebook.com/figules"
                    title="Discover Oleksandr's Facebook profile"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg class="menu-social-media-icon" width="24" height="24">
                      <use href="./images/icons.svg#icon-facebook"></use>
                    </svg>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- ENDREGION MENU -->

      <section class="hero">
        <div class="container hero-container">
          <h1 class="hero-title">REVENUE METRICS</h1>
          <p class="hero-text">SQL & TABLEAU</p>
        </div>
      </section>

      <!-- ENDREGION HEADER-HERO SECTION -->
    </header>

    <main>
      <div class="container">
        <h1>📊 Revenue Metrics Analysis</h1>

        <div class="section">
          <h2>🧠 Project Overview</h2>
          <p>
            <strong>Business Question:</strong> How is revenue evolving over
            time, and what are the key factors driving these changes?
          </p>
          <p>
            <strong>Dataset:</strong> User Activity and Revenue Generation
            (PostgreSQL Database, 3,026 rows)
          </p>
          <p>
            <strong>Outcome:</strong> Interactive dashboard that allows product
            managers to analyze and track the financial performance of a project
            based on user subscriptions and revenue.
          </p>
        </div>

        <div class="section">
          <h2>💻 SQL Logic</h2>
          <details>
            <summary>Click to View SQL Query</summary>
            <div class="sql-block">
              <pre>
                WITH base AS (
                  SELECT 
                    user_id,
                    payment_date,
                    revenue_amount_usd,
                    DATE_TRUNC('month', payment_date::DATE)::DATE AS paid_month,
                    game_name,
                    language,
                    age,
                    has_older_device_model,
                    LAG(DATE_TRUNC('month', payment_date::DATE)::DATE) OVER (PARTITION BY user_id ORDER BY payment_date) AS previous_paid_month,
                    LEAD(DATE_TRUNC('month', payment_date::DATE)::DATE) OVER (PARTITION BY user_id ORDER BY payment_date) AS next_paid_month
                  FROM newtable_oh
                ),

                dataset_end AS (
                  SELECT MAX(DATE_TRUNC('month', payment_date::DATE))::DATE AS max_month
                  FROM newtable_oh
                ),

                monthly_revenue AS (
                  SELECT 
                    user_id,
                    DATE_TRUNC('month', payment_date::DATE)::DATE AS paid_month,
                    SUM(revenue_amount_usd) AS total_month_revenue
                  FROM newtable_oh
                  GROUP BY user_id, paid_month
                )

                SELECT 
                  b.user_id,
                  b.payment_date,
                  b.revenue_amount_usd,
                  b.paid_month,
                  b.previous_paid_month,
                  b.next_paid_month,
                  CASE 
                    WHEN b.next_paid_month IS NULL AND b.paid_month + INTERVAL '1 month' <= de.max_month
                    THEN (b.paid_month + INTERVAL '1 month')::DATE
                    WHEN b.next_paid_month IS NOT NULL AND b.next_paid_month != b.paid_month + INTERVAL '1 month'
                    THEN (b.paid_month + INTERVAL '1 month')::DATE
                  END AS churn_month,
                  mr.total_month_revenue AS current_month_revenue,

                  -- Reactivated user flag and revenue
                  CASE 
                    WHEN b.previous_paid_month IS NOT NULL AND b.previous_paid_month != b.paid_month - INTERVAL '1 month' THEN 1 
                    ELSE 0
                  END AS reactivated_users,
                  CASE 
                    WHEN b.previous_paid_month IS NOT NULL AND b.previous_paid_month != b.paid_month - INTERVAL '1 month' 
                    THEN b.revenue_amount_usd 
                    ELSE 0 
                  END AS reactivated_mrr,

                  -- Expansion and Contraction revenue
                  CASE 
                    WHEN b.previous_paid_month = b.paid_month - INTERVAL '1 month'
                    AND mr.total_month_revenue > 
                            (SELECT total_month_revenue
                            FROM monthly_revenue
                            WHERE user_id = b.user_id 
                            AND paid_month = b.previous_paid_month)
                    THEN mr.total_month_revenue - 
                        (SELECT total_month_revenue
                          FROM monthly_revenue
                          WHERE user_id = b.user_id 
                          AND paid_month = b.previous_paid_month)
                    ELSE 0
                  END AS expansion_revenue,

                  CASE 
                    WHEN b.previous_paid_month = b.paid_month - INTERVAL '1 month'
                    AND mr.total_month_revenue < 
                            (SELECT total_month_revenue
                            FROM monthly_revenue
                            WHERE user_id = b.user_id 
                            AND paid_month = b.previous_paid_month)
                    THEN (SELECT total_month_revenue
                          FROM monthly_revenue
                          WHERE user_id = b.user_id 
                          AND paid_month = b.previous_paid_month) - mr.total_month_revenue
                    ELSE 0
                  END AS contraction_revenue,

                  b.game_name,
                  b.language,
                  b.age,
                  b.has_older_device_model

                FROM base b
                LEFT JOIN monthly_revenue mr 
                  ON b.user_id = mr.user_id AND b.paid_month = mr.paid_month
                JOIN dataset_end de ON TRUE

                ORDER BY 2,1;
              </pre>
            </div>
          </details>

          <h3>🧪 Query Output Preview</h3>
          <div class="table-container">
            <table class="sql-output">
                <thead>
                    <tr>
                        <th>user_id</th>
                        <th>payment_date</th>
                        <th>revenue_amount_usd</th>
                        <th>paid_month</th>
                        <th>previous_paid_month</th>
                        <th>next_paid_month</th>
                        <th>churn_month</th>
                        <th>current_month_revenue</th>
                        <th>reactivated_users</th>
                        <th>reactivated_mrr</th>
                        <th>expansion_revenue</th>
                        <th>contraction_revenue</th>
                        <th>game_name</th>
                        <th>language</th>
                        <th>age</th>
                        <th>has_older_device_model</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="odd">
                        <td>HxWcXHURvvtOJkrXAcDxQg==</td>
                        <td>2022-03-01</td>
                        <td>34.11</td>
                        <td>2022-03-01</td>
                        <td>&nbsp;</td>
                        <td>2022-03-01</td>
                        <td>2022-04-01</td>
                        <td>66.18</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>game 3</td>
                        <td>uk</td>
                        <td>15</td>
                        <td>false</td>
                    </tr>
                    <tr>
                        <td>l3sFUsG2qpcnrEzwRnjvtQ==</td>
                        <td>2022-03-01</td>
                        <td>15.06</td>
                        <td>2022-03-01</td>
                        <td>&nbsp;</td>
                        <td>2022-03-01</td>
                        <td>2022-04-01</td>
                        <td>38.100002</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>game 3</td>
                        <td>ru</td>
                        <td>15</td>
                        <td>false</td>
                    </tr>
                    <tr class="odd">
                        <td>o55dseByUOl9s5IQCz1kuQ==</td>
                        <td>2022-03-02</td>
                        <td>23.16</td>
                        <td>2022-03-01</td>
                        <td>&nbsp;</td>
                        <td>2022-04-01</td>
                        <td>&nbsp;</td>
                        <td>23.16</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>game 3</td>
                        <td>uk</td>
                        <td>22</td>
                        <td>false</td>
                    </tr>
                    <tr>
                        <td>7EPlnA7OQ9MhMx+od6FA9g==</td>
                        <td>2022-03-04</td>
                        <td>19.29</td>
                        <td>2022-03-01</td>
                        <td>&nbsp;</td>
                        <td>2022-03-01</td>
                        <td>2022-04-01</td>
                        <td>158.67</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>game 3</td>
                        <td>ru</td>
                        <td>23</td>
                        <td>false</td>
                    </tr>
                    <tr class="odd">
                        <td>Bcs3CbYx2EpbL9otxlEUmg==</td>
                        <td>2022-03-05</td>
                        <td>16.38</td>
                        <td>2022-03-01</td>
                        <td>&nbsp;</td>
                        <td>2022-03-01</td>
                        <td>2022-04-01</td>
                        <td>89.22</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>game 3</td>
                        <td>uk</td>
                        <td>18</td>
                        <td>true</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        

        <div class="section">
          <h2>📈 Tableau Dashboard</h2>
          <div
            class="tableauPlaceholder"
            id="viz1749317915301"
            style="position: relative"
          >
            <noscript
              ><a href="#"
                ><img
                  alt=" "
                  src="https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Re&#47;RevenueMetricsDashboard_17489368213960&#47;RevenueFlow&#47;1_rss.png"
                  style="border: none" /></a></noscript
            ><object class="tableauViz" style="display: none">
              <param
                name="host_url"
                value="https%3A%2F%2Fpublic.tableau.com%2F"
              />
              <param name="embed_code_version" value="3" />
              <param name="site_root" value="" />
              <param
                name="name"
                value="RevenueMetricsDashboard_17489368213960&#47;RevenueFlow"
              />
              <param name="tabs" value="yes" />
              <param name="toolbar" value="yes" />
              <param
                name="static_image"
                value="https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Re&#47;RevenueMetricsDashboard_17489368213960&#47;RevenueFlow&#47;1.png"
              />
              <param name="animate_transition" value="yes" />
              <param name="display_static_image" value="yes" />
              <param name="display_spinner" value="yes" />
              <param name="display_overlay" value="yes" />
              <param name="display_count" value="yes" />
              <param name="language" value="en-US" />
            </object>
          </div>
          <script type="text/javascript">
            var divElement = document.getElementById("viz1749317915301");
            var vizElement = divElement.getElementsByTagName("object")[0];
            if (divElement.offsetWidth > 800) {
              vizElement.style.width = "1200px";
              vizElement.style.height = "850px";
            } else if (divElement.offsetWidth > 500) {
              vizElement.style.width = "1200px";
              vizElement.style.height = "850px";
            } else {
              vizElement.style.width = "100%";
              vizElement.style.height = "2800px";
            }
            var scriptElement = document.createElement("script");
            scriptElement.src =
              "https://public.tableau.com/javascripts/api/viz_v1.js";
            vizElement.parentNode.insertBefore(scriptElement, vizElement);
          </script>

          <div class="insights">
            <h3>🔍 Key Insights</h3>
            <ul>
              <li>
                <strong>Top Regions:</strong> West & Central lead in sales
              </li>
              <li>
                <strong>Low Performer:</strong> South underperforming by
                <strong>~35%</strong> compared to average
              </li>
              <li>
                <strong>Product Trend:</strong> Technology accounts for
                <strong>~60%</strong> of total revenue
              </li>
              <li>
                <strong>Interactivity:</strong> Dashboard filters by Region,
                Segment, and Date
              </li>
            </ul>
          </div>
        </div>

        <div class="section">
          <h2>✅ Takeaways</h2>
          <ul>
            <li>
              🧠 <strong>SQL Skills:</strong> Joins, CTEs, aggregation,
              subqueries
            </li>
            <li>
              📊 <strong>Data Storytelling:</strong> Focused dashboard with
              filters and highlights
            </li>
            <li>
              🚀 <strong>Next Steps:</strong> Incorporate profit margin analysis
              + dynamic KPI alerts
            </li>
          </ul>
        </div>
      </div>
    </main>

    <!-- FOOTER -->

    <footer class="page-footer">
      <div class="container footer-container">
        <nav class="footer-nav">
          <ul class="footer-nav-list">
            <li class="footer-nav-item">
              <a href="./index.html" class="footer-nav-link">HOME</a>
            </li>
            <li class="footer-nav-item">
              <a href="./about.html" class="footer-nav-link">ABOUT ME</a>
            </li>
            <li class="footer-nav-item">
              <a href="./contact.html" class="footer-nav-link">CONTACT</a>
            </li>
          </ul>
        </nav>
        <div class="footer-contacts-logo">
          <address class="footer-contacts">
            <ul class="footer-contacts-list">
              <li class="footer-contacts-item">
                <a
                  class="footer-contacts-link"
                  href="mailto:honchar.analytics@gmail.com"
                  title="Email Oleksandr"
                  >honchar.analytics@gmail.com</a
                >
              </li>
              <li class="footer-contacts-item">
                <a
                  class="footer-contacts-link"
                  href="tel:+48733793430"
                  title="Call Oleksandr"
                  >+48 733 793 430</a
                >
              </li>
            </ul>
          </address>
          <a
            class="logo footer-logo"
            href="./index.html"
            title="Oleksandr's Logo back to page start"
          >
            <img src="./images/logo.ico" alt="Logo" class="logo-img" />
          </a>
        </div>
      </div>
    </footer>

    <script src="./js/menu.js"></script>

    <!-- ENDREGION BACKDROP -->
  </body>
</html>
